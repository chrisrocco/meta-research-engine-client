/*!
 * bigdata (https://uab-energetics.github.io/bigdata-app/html/)
 * Copyright 2017 chrisrocco
 * Licensed under the Themeforest Standard Licenses
 */

!function(global,factory){if("function"==typeof define&&define.amd)define("/DataService",["exports","src/es/URLs","AuthService"],factory);else if("undefined"!=typeof exports)factory(exports,require("src/es/URLs"),require("AuthService"));else{var mod={exports:{}};factory(mod.exports,global.URLs,global.AuthService),global.DataService=mod.exports}}(this,function(exports,_URLs,_AuthService){"use strict";function http(config){return config.url=API_BASE_PATH+config.url,config.headers={Authorization:"Bearer "+AuthService.getToken()},config.statusCode={500:reportError,401:handleUnauthorized},$.ajax(config).complete(function(res){AuthService.renew()})}function reportError(err){var report={};report=err.responseJSON?err.responseJSON:err.responseText?err.responseText:JSON.stringify(err);var activity=window.location.href;$.ajax({url:API_BASE_PATH+"/reportError",type:"POST",data:{activity:activity,error:report}}).complete(function(res){})}function handleUnauthorized(err){window.location="login.html"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.forkProject=exports.moreAssignmentsPlease=exports.handleUnauthorized=exports.reportError=exports.makeProjectOwner=exports.uploadPapersByID=exports.uploadPapersCSV=exports.postResetPassword=exports.postForgotPassword=exports.postProjectEnrollments=exports.postProjectStructure=exports.getProjectBuilderData=exports.postProject=exports.getProjectsData=exports.getUsersAssignments=exports.putAssignment=exports.getAssignment=exports.http=exports.loadReport=exports.loadConflictResolution=exports.loadAssignments=exports.loadCodeBook=exports.loadPaperCoder=exports.loadManageProject=void 0;var URLs=babelHelpers.interopRequireWildcard(_URLs),AuthService=babelHelpers.interopRequireWildcard(_AuthService),API_BASE_PATH=URLs.getUrl("api");exports.loadManageProject=function(projectKey){return http({url:"/loadManageProject?projectKey="+projectKey,method:"GET",dataType:"json"})},exports.loadPaperCoder=function(assignmentKey){return http({url:"/loadPaperCoder?key="+assignmentKey,method:"GET",dataType:"json"})},exports.loadCodeBook=function(){return http({url:"/loadCodeBook",method:"GET",dataType:"json"})},exports.loadAssignments=function(){return http({url:"/loadAssignments?userKey="+AuthService.getUser()._key,method:"GET",dataType:"json"})},exports.loadConflictResolution=function(assignmentKey){return http({url:"/loadConflictResolution?assignmentKey="+assignmentKey,method:"GET",dataType:"json"})},exports.loadReport=function(paperKey){return http({url:"/activities/report?paperKey="+paperKey,method:"GET",dataType:"json"})},exports.http=http,exports.getAssignment=function(key){return http({url:"/assignments/"+key,method:"GET",dataType:"json"})},exports.putAssignment=function(assignmentObject,async){return"undefined"==async&&(async=!0),http({url:"/assignments/"+assignmentObject._key,method:"PUT",async:async,data:{done:assignmentObject.done,completion:assignmentObject.completion,encoding:assignmentObject.encoding}})},exports.getUsersAssignments=function(id){return http({url:"/users/"+id+"/assignments",method:"GET",dataType:"json"})},exports.getProjectsData=function(){return http({url:"/loadProjects",method:"GET",dataType:"json"})},exports.postProject=function(projectObject){return http({url:"/projects",method:"POST",data:projectObject,dataType:"json"})},exports.getProjectBuilderData=function(projectKey){return http({url:"/loadProjectBuilder",method:"GET",data:{projectKey:projectKey},dataType:"json"})},exports.postProjectStructure=function(projectKey,structure){return http({url:"/projects/"+projectKey+"/structure",method:"POST",data:structure})},exports.postProjectEnrollments=function(registrationCode,userKey){return http({url:"/projects/members",method:"POST",data:{userKey:userKey,registrationCode:registrationCode},dataType:"json"})},exports.postForgotPassword=function(email){return http({url:"/users/recover",method:"POST",data:{email:email,callback:URLs.getUrl("resetPasswordCallback")}})},exports.postResetPassword=function(newPassword,hash_code){return http({url:"/users/reset",method:"POST",data:{hash_code:hash_code,newPassword:newPassword}})},exports.uploadPapersCSV=function(projectKey,formData){return http({url:"/projects/"+projectKey+"/papers",method:"POST",data:formData,dataType:"json"})},exports.uploadPapersByID=function(projectKey,pmcIDs){return http({url:"/projects/"+projectKey+"/papers/byPMCID",method:"POST",data:{pmcIDs:pmcIDs},dataType:"json"})},exports.makeProjectOwner=function(projectKey,otherUserEmail){return http({url:"/projects/"+projectKey+"/makeOwner",method:"POST",data:{userEmail:otherUserEmail},dataType:"json"})},exports.reportError=reportError,exports.handleUnauthorized=handleUnauthorized,exports.moreAssignmentsPlease=function(userKey,projectKey,howMany){return http({url:"/moreAssignmentsPlease",method:"POST",data:{userKey:userKey,projectKey:projectKey,howMany:howMany}})},exports.forkProject=function(projectKey,newName,newDescription){return http({url:"/projects/"+projectKey+"/fork",method:"POST",data:{name:newName,description:newDescription}})}});